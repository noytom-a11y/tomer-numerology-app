# ====================================================
# Numerology_TomerOlamNoy.py - ×§×•×“ ××œ× (×›×•×œ×œ ×ª×“×¨×™× ×“×™× ××™×™×)
# ====================================================
import streamlit as st
import pandas as pd
from datetime import datetime
import re

# 1. ×§×‘×•×¢×™× ×’×œ×•×‘×œ×™×™× ×•×”×’×“×¨×•×ª
# ----------------------------------------------
MASTER_NUMBERS = {11, 22}
ALL_MASTER_NUMBERS = {11, 22, 33} 
KARMIC_NUMBERS = {13, 14, 16, 19}
SPECIAL_NUMBERS = ALL_MASTER_NUMBERS.union(KARMIC_NUMBERS)

ASTRO_MAP = {
    '×’×“×™': 8, '×“×œ×™': 11, '×“×’×™×': 7, '×˜×œ×”': 9, '×©×•×¨': 33, '×ª××•××™×': 5,
    '×××–× ×™×™×': 6, '×¡×¨×˜×Ÿ': 2, '××¨×™×”': 1, '×‘×ª×•×œ×”': 4, '×¢×§×¨×‘': 22, '×§×©×ª': 3
}

GIMATRIA_MAP = {
    '×': 1, '×”': 5, '×•': 6, '×™': 1, '×‘': 2, '×’': 3, '×“': 4, '×–': 7, '×—': 8, 
    '×˜': 9, '×›': 2, '×œ': 3, '×': 4, '× ': 5, '×¡': 6, '×¢': 7, '×¤': 8, '×¦': 9, 
    '×§': 1, '×¨': 2, '×©': 3, '×ª': 4, 
    '×¥': 9, '×£': 8, '×': 4, '×š': 2, '×Ÿ': 5 
}
VOWEL_LETTERS = {'×', '×”', '×•', '×™'}
CONSONANTS = set(GIMATRIA_MAP.keys()) - VOWEL_LETTERS 
VOWELS_MAP = {k: GIMATRIA_MAP[k] for k in VOWEL_LETTERS}

# ××¤×ª ×˜×§×¡×˜ ×¢×•×¦××•×ª
STRENGTH_TEXT_MAP = {
    'MASTER': 'â­ ×ª×“×¨ ×××¡×˜×¨ ×—×–×§',
    'STRONG': 'âœ… ×ª×“×¨ ×—×–×§ ×•××§×“×',
    'MEDIUM': 'â– ×ª×“×¨ ×××•×–×Ÿ',
    'WEAK': 'âš ï¸ ×ª×“×¨ ×—×œ×©/××¢×›×‘',
    'KARMIC': 'âŒ ×ª×“×¨ ×§××¨××ª×™ - ×”×™×–×”×¨',
    'NEUTRAL': 'â– ×ª×“×¨ ×××•×–×Ÿ (×‘×¨×™×¨×ª ××—×“×œ)'
}

# ğŸš¨ ××©×¤×˜ ×”×§××¨××” ×”××‘×•×§×©
KARMIC_WARNING = "× ×˜×™×™×” ×œ×—×©×™×‘×” ×¨××©×•× ×” ×©×œ×™×œ×™×ª. ×¨×¦×•×™ ×œ×§×‘×œ ×”×—×œ×˜×•×ª ×¨×§ ×œ××—×¨ ×©× ×¨×’×¢×™× ×•×œ×”×ª×™×™×—×¡ ×œ×—×©×™×‘×” ×”×©× ×™×™×” ×•×œ× ×œ×¨××©×•× ×”."

# ğŸš¨ ××¤×•×ª ×”× ×™×ª×•×— ×”××¨×•×›×–×•×ª (× ×©××¨ ×›×¤×™ ×©×”×™×”)
CHAKRA_ANALYSIS = {
    # ×”×•×ª×× ×'×¦'××§×¨×ª ×”×‘×¡×™×¡'
    '×ª×“×¨ ×¡×‘×™×‘×ª×™': { 
        1: "×”×¡×‘×™×‘×” ×ª×•×¤×¡×ª ××ª ×”××“× ×›××•×‘×™×œ ×˜×‘×¢×™ ×•×›×“××•×ª ×¡×•×—×¤×ª.",
        2: "×”×¡×‘×™×‘×” ×ª×•×¤×¡×ª ××ª ×”××“× ×›×“××•×ª ××©×¤×—×ª×™×ª ×”××—×¤×©×ª ×–×•×’×™×•×ª ×•×™×¦×™×‘×•×ª ×¨×’×©×™×ª.",
        3: "×”×¡×‘×™×‘×” ×¨×•××” ××ª ×”××“× ×›×—×•×‘×‘ ×—×‘×¨×”, ×©××—×”, ×˜×™×•×œ×™× ×•×‘×¢×œ ×× ×¨×’×™×” ×§×œ×™×œ×”.",
        4: "×”×¡×‘×™×‘×” ×¨×•××” ××ª ×”××“× ×›××™ ×©××¢×¨×™×š ××¡×’×¨×ª, ×™×¦×™×‘×•×ª ×•×‘×¡×™×¡ ×‘×˜×•×—.",
        5: "×”×¡×‘×™×‘×” ×¨×•××” ××ª ×”××“× ×›×ª×§×©×•×¨×ª×™ ×‘×™×•×ª×¨ ×•×‘×¢×œ ×™×›×•×œ×ª ×‘×™×˜×•×™ ×’×‘×•×”×”.",
        6: "×”×¡×‘×™×‘×” ×ª×•×¤×¡×ª ××•×ª×• ×›×“××•×ª ××©×¤×—×ª×™×ª ×•×‘×¢×œ×ª × ×ª×™× ×” ×’×‘×•×”×”, ×œ×¢×™×ª×™× ×¢×“ ×›×“×™ ×‘×™×˜×•×œ ×¢×¦××™ ×•×¨×™×¦×•×™ ×™×ª×¨.",
        7: "×‘×—×•×•×™×” ×”×¤× ×™××™×ª ××¨×’×™×© ×©×•× ×” (×“×•××” ×œ-16). ×‘×—×‘×¨×” ×”×•× × ×•×˜×” ×œ×”×™×•×ª ×©×§×˜ ×™×•×ª×¨, ××•×”×‘ ×œ×”×§×©×™×‘, ×œ×¦×¤×•×ª ×•×œ× ×ª×— ×”×ª× ×”×’×•×™×•×ª. ××•×”×‘ ×œ×¦×‘×•×¨ ×™×“×¢.",
        8: "×”×¡×‘×™×‘×” ×ª×•×¤×¡×ª ××ª ×”××“× ×›×—×–×§, ×‘×¢×œ ×™×›×•×œ×•×ª × ×™×”×•×œ×™×•×ª ×’×‘×•×”×•×ª ×•××—×¤×© ××™×–×•×Ÿ ×‘×™×Ÿ ×¨×•×—× ×™×•×ª ×œ×’×©××™×•×ª.",
        9: "×”×¡×‘×™×‘×” ×¨×•××” ×¤×•×˜× ×¦×™××œ ×’×‘×•×” ×•×‘×œ×ª×™ ×××•××©. ××“× ×©× ×•×œ×“ ×œ×”×•×‘×™×œ ×“×¨×š.",
        11: "×”×¡×‘×™×‘×” ×ª×•×¤×¡×ª ××ª ×”××“× ×›×‘×¢×œ ×¤×•×˜× ×¦×™××œ ×’×“×•×œ, ××š ×”×•× ×¢×œ×•×œ ×œ×”×ª×§×©×•×ª ×œ×××©×•.",
        13: f"×”×¡×‘×™×‘×” ×¨×•××” ××•×ª×• ×›× ×•×§×©×”, ×§×©×” ×•×‘×™×§×•×¨×ª×™. ××ª×§×©×” ×‘×–×•×’×™×•×ª ×•××•×”×‘ ×©×“×‘×¨×™× × ×¢×©×™× ××š ×•×¨×§ ×‘×“×¨×š ×©×œ×•. {KARMIC_WARNING}",
        14: f"×××•×¤×™×™×Ÿ ×‘×§×•×©×™ ×‘××¢×¨×›×•×ª ×™×—×¡×™× ×–×•×’×™×•×ª (×“×—×£ ×œ×¤×¨×§×Ÿ) ×•×‘× ×˜×™×™×” ×œ×‘×–×‘×–× ×•×ª. '××” ×©×”××“× ××¨×•×•×™×—, ×”×›×¡×£ ×™×•×¨×“ ×œ×˜××™×•×Ÿ'. {KARMIC_WARNING}",
        16: f"××“× ×¢× × ×˜×™×™×” ×œ×”×¤×¡×“×™× ×›×¡×¤×™×™× ×•×‘×¢×™×•×ª ×‘×–×•×’×™×•×ª. ×‘×—×•×•×™×” ×”×¤× ×™××™×ª ××¨×’×™×© ×©×•× ×” ×•×¢× ×¢×™×›×•×‘×™× ×§×©×™× ×‘××™××•×©. {KARMIC_WARNING}",
        19: f"×××•×¤×™×™×Ÿ ×‘×”×¨×’×©×ª ×§×•×¨×‘× ×•×ª. ××¤×” ×—×œ×©×”: ×—×•×•×” ×§×•×¨×‘×Ÿ. ××¤×” ×—×–×§×”: × ×•×˜×” ×œ××§×¨×‘×Ÿ ×‘×–×•×’×™×•×ª. {KARMIC_WARNING}",
        22: "×”×¡×‘×™×‘×” ×¨×•××” ××“× ×›×¨×™×–××˜×™, ××”×•×‘ ×•××•×‘×™×œ, ××‘×œ ×©××ª×§×©×” ×œ×××© ××ª ×”×¤×•×˜× ×¦×™××œ ×©×œ×•."
    },
    # ×”×•×ª×× ×'×¦'××§×¨×ª ×”×¢×œ'
    '×ª×“×¨ ×”×©×': { 
        1: "×ª×“×¨ ×× ×¨×’×˜×™ ×—×™×•×‘×™ ×”××§×“× ××ª ×”××“× ××‘×—×™× ×” ×× ×¨×’×˜×™×ª.",
        2: "××™×Ÿ ×”×©×¤×¢×” ×× ×¨×’×˜×™×ª ××©××¢×•×ª×™×ª ×¢×œ ×”××¤×”.",
        3: "×ª×“×¨ ×× ×¨×’×˜×™ ×˜×•×‘ ×”××§×“× ××ª ×”××“×.",
        4: "××™×Ÿ ×”×©×¤×¢×” ×× ×¨×’×˜×™×ª ××©××¢×•×ª×™×ª ×¢×œ ×”××¤×”.",
        5: "×ª×“×¨ ×× ×¨×’×˜×™ ×˜×•×‘ ×”××§×“× ×ª×§×©×•×¨×ª. ×ª×“×¨ ×× ×¨×’×˜×™ ×˜×•×‘ ×”××§×“× ××ª ×”××“×.",
        6: "××™×Ÿ ×”×©×¤×¢×” ×× ×¨×’×˜×™×ª ××©××¢×•×ª×™×ª ×¢×œ ×”××¤×”.",
        7: "×¢×œ×•×œ ×œ×’×¨×•× ×œ×¢×™×›×•×‘×™× ×§×œ×™× ×•×œ×‘×¢×™×•×ª × ×¤×©×™×•×ª ×§×œ×•×ª.",
        8: "×ª×“×¨ ×× ×¨×’×˜×™ ×˜×•×‘ ×”××§×“× ××ª ×”××“×.",
        9: "×ª×“×¨ ×× ×¨×’×˜×™ ×˜×•×‘ ×”××§×“× ××ª ×”××“×.",
        11: "×ª×“×¨ ×× ×¨×’×˜×™ ×˜×•×‘ ×”××§×“× ××ª ×”××“×.",
        13: f"×¢×¨×š ×§××¨××ª×™ ×”××¦×‘×™×¢ ×¢×œ × ×•×§×©×•×ª ×©×œ ×”××“×. {KARMIC_WARNING} | ×”×¡×‘×™×‘×” ×¨×•××” ××•×ª×• ×›× ×•×§×©×”, ×§×©×” ×•×‘×™×§×•×¨×ª×™. ××ª×§×©×” ×‘×–×•×’×™×•×ª ×•××•×”×‘ ×©×“×‘×¨×™× × ×¢×©×™× ××š ×•×¨×§ ×‘×“×¨×š ×©×œ×•.",
        14: f"×¢×¨×š ×§××¨××ª×™. {KARMIC_WARNING} | ×××•×¤×™×™×Ÿ ×‘×§×•×©×™ ×‘××¢×¨×›×•×ª ×™×—×¡×™× ×–×•×’×™×•×ª (×“×—×£ ×œ×¤×¨×§×Ÿ) ×•×‘× ×˜×™×™×” ×œ×‘×–×‘×–× ×•×ª. '××” ×©×”××“× ××¨×•×•×™×—, ×”×›×¡×£ ×™×•×¨×“ ×œ×˜××™×•×Ÿ'.",
        16: f"×¢×¨×š ×§××¨××ª×™. {KARMIC_WARNING} | ××“× ×¢× × ×˜×™×™×” ×œ×”×¤×¡×“×™× ×›×¡×¤×™×™× ×•×‘×¢×™×•×ª ×‘×–×•×’×™×•×ª. ×‘×—×•×•×™×” ×”×¤× ×™××™×ª ××¨×’×™×© ×©×•× ×” ×•×¢× ×¢×™×›×•×‘×™× ×§×©×™× ×‘××™××•×©.",
        19: f"×¢×¨×š ×§××¨××ª×™. {KARMIC_WARNING} | ×××•×¤×™×™×Ÿ ×‘×”×¨×’×©×ª ×§×•×¨×‘× ×•×ª. ××¤×” ×—×œ×©×”: ×—×•×•×” ×§×•×¨×‘×Ÿ. ××¤×” ×—×–×§×”: × ×•×˜×” ×œ××§×¨×‘×Ÿ ×‘×–×•×’×™×•×ª.",
        22: "×ª×“×¨ ×× ×¨×’×˜×™ ×˜×•×‘ ×”××§×“× ××ª ×”××“×."
    },
    # ×”×•×ª×× ×'×¦'××§×¨×ª ×”××™×Ÿ ×•×”×™×¦×™×¨×”'
    '×ª×“×¨ ×ª×¢×¡×•×§×”': { 
        1: "×™×›×•×œ×•×ª ×ª×¢×¡×•×§×” ××¢×•×œ×•×ª: ×”×¦×œ×—×” ××¨×•×‘×” ×›×× ×”×™×’, ×× ×”×œ/×¡×× ×›\"×œ ××• ×¢×¦×××™ ×‘×›×œ ×ª×—×•× (×›×•×œ×œ ×¢×‘×•×“×ª ×›×¤×™×™×). ×× ×¨×’×™×” ×—×–×§×” ×©×“×•×—×¤×ª ×œ×”×¦×œ×—×” ×œ×œ× ×ª× ××™.",
        2: "××ª××™× ×œ×¢×‘×•×“×” ×‘××ª×Ÿ ×©×™×¨×•×ª (×¤×§×™×“×•×ª, ×”×•×¨××”, ×˜×™×¤×•×œ). × ×˜×™×™×” ×œ×”×™×•×ª ×©×›×™×¨ ×•×§×•×©×™ ×‘×”×©×’×ª ××©×›×•×¨×•×ª ×’×‘×•×”×•×ª.",
        3: "×›×™×©×•×¨×™ ×ª×¢×¡×•×§×” ××¦×•×™× ×™×, ××ª××™× ×œ×¢×‘×•×“×” ×¢×œ ×‘××”, ×”×•×¨××”, ××›×™×¨×•×ª, ×ª×§×©×•×¨×ª, ××—×©×‘×™×, ×¡×¤×•×¨×˜ ×•××•×–×™×§×”. ××¡×•×’×œ ×œ×¢×‘×•×“ ×‘×›×œ ×ª×—×•×.",
        4: "×™×›×•×œ×•×ª ×ª×¢×¡×•×§×” ×‘×™× ×•× ×™×•×ª, ××ª××™× ×œ××ª×Ÿ ×©×™×¨×•×ª ×›×©×›×™×¨. ××•×˜×™×‘×¦×™×” ×ª×¢×¡×•×§×ª×™×ª ×œ× ×’×‘×•×”×”.",
        5: "×›×™×©×•×¨×™ ×ª×¢×¡×•×§×” ×™×™×—×•×“×™×™× ×•××¦×•×™× ×™× ×‘×ª×—×•××™× ×›××• ×¡×¤×•×¨×˜, ××•×–×™×§×”, ××—×©×‘×™× ×•×¨××™×™×ª ×—×©×‘×•×Ÿ. ×™×›×•×œ×ª ×œ×”×’×™×¢ ×œ×ª×¤×§×™×“×™× ×‘×›×™×¨×™× ×•×¤×•×˜× ×¦×™××œ ×’×‘×•×” ×œ×¨×•×•×—×™×.",
        6: "×›××• ×™×›×•×œ×•×ª 4: ××ª××™× ×™×•×ª×¨ ×œ××ª×Ÿ ×©×™×¨×•×ª ×›×©×›×™×¨.",
        7: "×›×™×©×•×¨×™ ×ª×¢×¡×•×§×” ×§×©×™× ×œ×™×™×©×•× (×”×•×¨××”, ×¨×¤×•××”, ×”×™×™×˜×§). ×¨×•×‘× ×¢×•×‘×“×™× ×‘××ª×Ÿ ×©×™×¨×•×ª ×•××ª×§×©×™× ×œ×××© ××ª ×”×¤×•×˜× ×¦×™××œ ×”×’×‘×•×”.",
        8: "×™×›×•×œ×•×ª ×ª×¢×¡×•×§×” ×”×˜×•×‘×•×ª ×‘×¢×•×œ×, ××ª××™××•×ª ×œ× ×™×”×•×œ ×× ×©×™×, ×¢×¡×§×™× ××¦×œ×™×—×™×, ×™×™×¢×•×¥ ×”×©×§×¢×•×ª, ×‘×™×˜×•×— ×•×¢×•\"×“. × ×× ×¢×™× ××¢×‘×•×“×ª ×›×¤×™×™×, ×‘×¢×œ×™ ×™×›×•×œ×ª ×œ×”×ª××•×“×“ ×¢× ×§×”×œ ×’×“×•×œ.",
        9: "×™×›×•×œ×•×ª ×ª×¢×¡×•×§×” ×‘×™× ×•× ×™×•×ª. ×¡×™×›×•×™ × ××•×š ×œ××™××•×© ××œ×•× ×”×¤×•×˜× ×¦×™××œ. × ×•×˜×” ×œ×¢×‘×•×“ ×‘××ª×Ÿ ×©×™×¨×•×ª (×›××• 2, 4, 6).",
        11: "×›××• ×™×›×•×œ×•×ª 9: × ×•×˜×” ×œ×¢×‘×•×“ ×‘××ª×Ÿ ×©×™×¨×•×ª ×•××ª×§×©×” ×œ×××© ×¤×•×˜× ×¦×™××œ.",
        13: f"×™×•×¦×¨ ×§×•×©×™, ×—×•×¡×¨ ×¡×™×¤×•×§ ×•×§×•×©×™ ×‘××™××•×© ×”×¤×•×˜× ×¦×™××œ. ×œ×¨×•×‘ ×™×”×™×” ×©×›×™×¨. {KARMIC_WARNING}",
        14: f"×›××• ×™×›×•×œ×•×ª 13. ×™×™×—×•×“×™ ×‘×›×š ×©×™×›×•×œ ×œ×”×¦×˜×™×™×Ÿ ×’× ×‘×ª×—×•××™ ×¡×¤×•×¨×˜ ×•××•×–×™×§×”. {KARMIC_WARNING}",
        16: f"×›××• ×™×›×•×œ×•×ª 13. ×™×•×¦×¨ ×§×•×©×™, ×—×•×¡×¨ ×¡×™×¤×•×§ ×•×§×•×©×™ ×‘××™××•×© ×”×¤×•×˜× ×¦×™××œ. ×œ×¨×•×‘ ×™×”×™×” ×©×›×™×¨. {KARMIC_WARNING}",
        19: f"××¦×“ ××—×“ ×™×›×•×œ×•×ª ××¦×•×™× ×•×ª (19=1), ××š ×™×© ×§×•×©×™ ×œ×”×’×™×¢ ×œ×™×›×•×œ×•×ª ×©×œ 1. ×¨×¢×™×•× ×•×ª ××¦×•×™× ×™×, ×§×•×©×™ ×’×“×•×œ ×‘×™×™×©×•×. ××¦×œ×™×— ×œ×××© ×¢×“ 70% ××”×¤×•×˜× ×¦×™××œ. × ×˜×™×™×” ×œ×“×‘×¨×™× ×œ×”×©×ª×‘×©, ××•×˜×™×‘×¦×™×” ×’×‘×•×”×” ××š ×™×™×©×•× ×‘×™× ×•× ×™. {KARMIC_WARNING}",
        22: "×›××• ×™×›×•×œ×•×ª 9: × ×•×˜×” ×œ×¢×‘×•×“ ×‘××ª×Ÿ ×©×™×¨×•×ª ×•××ª×§×©×” ×œ×××© ×¤×•×˜× ×¦×™××œ.",
        33: "×›××• ×™×›×•×œ×•×ª 6/4: × ×•×˜×” ×œ×¢×‘×•×“ ×‘××ª×Ÿ ×©×™×¨×•×ª ×•××ª×§×©×” ×œ×××© ×¤×•×˜× ×¦×™××œ."
    },
    # ×”×•×ª×× ×'×¦'××§×¨×ª ××§×œ×¢×ª ×”×©××©'
    '×ª×“×¨ ×”×™×™×¢×•×“': { 
        1: "×”×™×™×¢×•×“ ×”×•× ×œ×”× ×”×™×’: ×œ×”×™×•×ª ×œ×™×“×¨, ×œ×¢××•×“ ×¢×œ ×‘××”, ×œ×”×¢×‘×™×¨ ×™×“×¢, ×œ×”×™×•×ª ×¢×¦×××™. ×× ×¨×’×™×” ××•×‘×™×œ×” ×•×—×–×§×” ×”××§×œ×” ×¢×œ ×”×¦×œ×—×”.",
        2: "×”×™×™×¢×•×“ ×”×•× ×©×™×ª×•×£ ×¤×¢×•×œ×”: ×œ×”×™×•×ª ××™×© ××©×¤×—×”, ×œ×¢×‘×•×“ ×‘×¦×•×•×ª×™× ×•×œ×˜×¤×œ. × ×˜×™×™×” ×œ×¨×’×©× ×•×ª ×•×—×¨×“×•×ª (×”×¦×•×¨×š ×‘×¤×¢×•×œ×” ××©×•×ª×¤×ª).",
        3: "×”×™×™×¢×•×“ ×”×•× ×§×œ×™×œ×•×ª ×•×©××—×”: ×œ×©××•×¨ ×¢×œ ×”×™×œ×“ ×”×¤× ×™××™, ×œ×˜×™×™×œ, ×œ×‘×œ×•×ª ×‘×—×‘×¨×”, ×œ×¢××•×“ ×¢×œ ×‘××” ×•×œ×”×™×•×ª ×©××—. ××©×™×›×” ×œ×¡×¤×•×¨×˜, ××•×–×™×§×” ×•××¡×ª×˜×™×§×”.",
        4: "×”×™×™×¢×•×“ ×”×•× ×™×¦×™×‘×•×ª ×•××¡×’×¨×ª: ×œ×”×™×•×ª ××“× ××¡×•×“×¨ ×•×××•×¨×’×Ÿ ×©×—×™ ×‘××¡×’×¨×•×ª; ××“× ××©×¤×—×ª×™ ×¢× ×‘×¡×™×¡ ×—×–×§.",
        5: "×”×™×™×¢×•×“ ×”×•× ×ª×§×©×•×¨×ª ×•×’×‘×•×œ×•×ª: ×œ×¢××•×“ ×¢×œ ×‘××”, ×œ×”×¢×‘×™×¨ ×™×“×¢, ×ª×§×©×•×¨×ª, ××“×™×”, ××—×©×‘×™× ×•×¨××™×™×ª ×—×©×‘×•×Ÿ. ×§×œ ×œ×”×¦×œ×™×— ×‘×—×™×™×.",
        6: "×”×™×™×¢×•×“ ×”×•× × ×ª×™× ×” ×•××©×¤×—×”: ×œ×”×™×•×ª '××œ×š ×”××©×¤×—×”' ×•×œ×©×¨×ª ××ª ×”×¡×‘×™×‘×”. × ×˜×™×™×” ×œ×ª×—×•××™ ××¡×ª×˜×™×§×” ×•×˜×™×¤×•×œ. ×§×™×™× ×§×•×©×™ ×‘×§×‘×œ×ª ×¢×–×¨×” (× ×˜×™×™×” ×œ×¨×™×¦×•×™). ×§×œ ×œ××™××•×©.",
        7: "×”×™×™×¢×•×“ ×”×•× ×”×ª×—×‘×¨×•×ª ×¢×¦××™×ª ×•×™×“×¢: ×œ×”×ª×’×‘×¨ ×¢×œ ×—×¨×“×•×ª ×•×œ×—×¦×™×, ×œ×¦×‘×•×¨ ×™×“×¢ ×•×œ×”×ª×—×‘×¨ ×œ×¨×•×—× ×™×•×ª. × ×˜×™×™×” ×œ×¤×¢×•×œ ××”×¨×’×© ×•×œ× ××”×©×›×œ (××•××œ×¥ ×œ×”×ª× ×”×œ ×©×›×œ×™×ª). ×”×™×™×¢×•×“ ×”××©× ×™ ×”×•× ×œ×¢××•×“ ×¢×œ ×‘××” ×›'×—×›×' ××• '× ×‘×“×œ'.",
        8: "×”×™×™×¢×•×“ ×”×•× ××™×–×•×Ÿ ×•× ×™×”×•×œ: ×œ×”×™×•×ª ×× ×”×œ, ×¢×¦×××™ ×¢×©×™×¨ ×•×œ×¤×¨× ×¡ ××©×¤×—×”, ×ª×•×š ××™×–×•×Ÿ ×‘×™×Ÿ ×¨×•×—× ×™×•×ª ×œ×’×©××™×•×ª. ×§×©×” ×××•×“ ×œ××™××•×© (× ×“×™×¨). ×”×™×™×¢×•×“ ×”××©× ×™ ×”×•× ×”×¢×‘×¨×ª ×™×“×¢.",
        9: "×™×™×¢×•×“ ×××¡×˜×¨ (×”×’×‘×•×” ×‘×™×•×ª×¨): ×œ×”×•×‘×™×œ ×“×¨×š ×¨×•×—× ×™×ª/×¢×•×œ××™×ª, ×œ×”××¦×™× ×“×‘×¨×™× ×œ××¢×Ÿ ×”×× ×•×©×•×ª ×•×œ×˜×¤×œ ×‘×¡×‘×™×‘×”. × ×•×œ×“ ×œ××¢×Ÿ ××—×¨×™×. × ×“×¨×©×ª ××¤×” ×—×–×§×” ×œ××™××•×©.",
        11: "×™×™×¢×•×“ ×××¡×˜×¨ (×”××˜×¤×œ ×”×’×“×•×œ): ×”××¡×¢ ×©×œ×”× ×”×•× ×œ×”×¤×•×š ×××˜×•×¤×œ ×•×ª×œ×•×ª×™ ×œ××“× ×—×–×§ ×©××˜×¤×œ ×‘×× ×©×™×. ×¦×¨×™×›×™× ××¤×” ×—×–×§×” ×›×“×™ ×œ×”×’×©×™× ××ª ×™×™×¢×•×“ ×”×××¡×˜×¨.",
        13: f"×”×™×™×¢×•×“ ×”×•× ×ª×™×§×•×Ÿ ×§×¨××ª×™: ×œ×”×©×ª×—×¨×¨ ×××•×’×‘×œ×•×ª (×¤×™×–×™×ª/× ×¤×©×™×ª/×× ×˜×œ×™×ª), ×× ×•×§×©×•×ª, ×—×©×™×‘×” ×©×œ×™×œ×™×ª ×•×‘×™×§×•×¨×ª×™×•×ª. ×œ××¦×•× ×©×œ×•×•×” ×•×—×•×¤×©. {KARMIC_WARNING}",
        14: f"×”×™×™×¢×•×“ ×”×•× ×ª×™×§×•×Ÿ ×§×¨××ª×™: ×œ×”×©×ª×—×¨×¨ ××“×—×£ ×‘×œ×ª×™ × ×©×œ×˜ ×œ×—×•×¤×© ××•×—×œ×˜, ×œ×¤×ª×— ×™×¦×™×‘×•×ª ××©×¤×—×ª×™×ª ×•×›×œ×›×œ×™×ª. × ×˜×™×™×” ×œ×‘×–×‘×–× ×•×ª, ×œ×§×™×—×ª ×¡×™×›×•× ×™× ×•×”×©×ª×¢×××•×ª. {KARMIC_WARNING}",
        16: f"×”×™×™×¢×•×“ ×”×××ª×’×¨ ×‘×™×•×ª×¨ (×§××¨××” ×¨×•×—× ×™×ª): ×˜×™×¤×•×œ ×‘× ×¤×©, ×”×ª×’×‘×¨×•×ª ×¢×œ ×—×¨×“×•×ª, ×§×¨×™×¡×•×ª × ×¤×©×™×•×ª ×•×“×™×›××•×Ÿ. ×”×ª×™×§×•×Ÿ ×”×•× ×—×™×‘×•×¨ ×œ×¨×•×—× ×™×•×ª, × ×ª×™× ×”, ×•×˜×™×¤×•×œ ×‘××—×¨×™× (×¨×¤×•××”, ×¤×¡×™×›×•×œ×•×’×™×”). {KARMIC_WARNING}",
        19: f"×”×™×™×¢×•×“ ×”×•× ×ª×™×§×•×Ÿ ×§×¨××ª×™: ×œ×”×©×ª×—×¨×¨ ××§×•×¨×‘× ×•×ª ×•×œ×œ××•×“ ×œ×”×™×•×ª ×”×× ×”×œ (×œ× ×”×¡×’×Ÿ). ×œ×¨×•×‘ ×—×•×•×™× × ×™×¦×•×œ ××©××¢×•×ª×™ ×‘×©×™× ×”×¨××©×•×Ÿ ×©×œ ×”×—×™×™×. {KARMIC_WARNING}",
        22: "×“×•××” ×œ×¢×¨×š 4, ×¤×•×˜× ×¦×™××œ ×××¡×˜×¨.",
        33: "×”×™×™×¢×•×“ ×œ×”×™×•×ª ××™×© ××©×¤×—×”, ×œ×”×©×ª×—×¨×¨ ××¨×¦×•×Ÿ ×œ×©×œ×™×˜×” ×‘××©×¤×—×” ×•×‘×‘× ×™ ×–×•×’, ×œ×”×ª×¢×¡×§ ×‘×¨×•×—× ×™×•×ª, ×›×ª×™×‘×” ×•×™×¦×™×¨×”."
    },
    # ×”×•×ª×× ×'×¦'××§×¨×ª ×”×œ×‘'
    '×ª×“×¨ ×”×—×•×¡×¨': { 
        0: "×¦'××§×¨×ª ×”×œ×‘: ×‘××¦×‘ ×××•×–×Ÿ ××• ×‘××¦×•×§×” ×§××¨××ª×™×ª. 0 ×‘××™× ×•×¡ (×¢× ×§××¨××”): ×¨×¦×•×Ÿ ×œ×§×‘×œ ×¨×™×¤×•×™, × ××¦× ×‘××¦×•×§×” ×•×—×•×¡×¨ ×©×‘×™×¢×•×ª ×¨×¦×•×Ÿ ×¤× ×™××™×ª. 0 ×‘×¤×œ×•×¡ (×¢× ×××¡×˜×¨): ×¨×¦×•×Ÿ ×œ×ª×ª ×¨×™×¤×•×™, ××¤×” ×××•×–× ×ª.",
        1: "×ª×—×•×©×ª ×—×•×¡×¨ ×‘×× ×”×™×’×•×ª; ×¨×¦×•×Ÿ ×œ×”×•×‘×™×œ ×™×•×ª×¨. ×œ×¤×¢××™× ××ª× ×”×œ ×××’×•.",
        2: "×ª×—×•×©×” ×©×œ ×—×•×¡×¨ ×‘×–×•×’×™×•×ª ×•×‘××©×¤×—×ª×™×•×ª.",
        3: "×ª×—×•×©×” ×©×œ ×—×•×¡×¨ ×—×•×¤×©, ×§×œ×™×œ×•×ª ×•×©××—×ª ×—×™×™×.",
        4: "×ª×—×•×©×” ×©×œ ×¨×¦×•×Ÿ ××•×’×‘×¨ ×œ××¡×’×¨×ª×™×•×ª, ×™×¦×™×‘×•×ª ×•×¡×“×¨.",
        5: "×ª×—×•×©×” ×©×œ ×—×•×¡×¨ ×‘×ª×§×©×•×¨×ª; ×¨×¦×•×Ÿ ×œ×”×™×•×ª ×™×•×ª×¨ ×ª×§×©×•×¨×ª×™.",
        6: "×ª×—×•×©×” ×©×œ ×—×•×¡×¨ ×‘××©×¤×—×ª×™×•×ª ×•×‘××™×–×•×Ÿ × ×ª×™× ×”-×§×‘×œ×”.",
        7: "×ª×—×•×©×” ×©×œ ×—×•×¡×¨ ×‘×™×“×¢; ×¨×¦×•×Ÿ ×œ×œ××•×“ ×•×œ×¦×‘×•×¨ ×™×“×¢.",
        8: "×ª×—×•×©×” ×©×œ ×—×•×¡×¨ ×‘×™×›×•×œ×•×ª × ×™×”×•×œ; ×¦×•×¨×š ×‘××™×–×•×Ÿ ×‘×™×Ÿ ×”×¨×•×—× ×™×•×ª ×œ×’×©××™×•×ª ×•×œ×—×–×§ ××ª ×™×›×•×œ×•×ª ×”× ×™×”×•×œ."
    },
    # ×”×•×ª×× ×'×¦'××§×¨×ª ×”×’×¨×•×Ÿ'
    '×ª×“×¨ ×”×‘×™×˜×•×™ ×•×”×—×©×™×‘×”': { 
        0: "×× ×‘×¤×œ×•×¡: ×¨×¦×•×Ÿ ×œ×¨×¤× ××ª ×”×¢×•×œ×. ×× ×‘××™× ×•×¡: ×¨×¦×•×Ÿ ×œ×§×‘×œ ×¨×™×¤×•×™. ×“×•××” ×œ×× ×¨×’×™×” ×©×œ 2: ×§×©×™×™× ×‘×–×•×’×™×•×ª, ×§×•×©×™ ×œ×”×™×•×ª ×¢×¦×××™ ×•××¦×œ×™×— ×œ×‘×“.",
        1: "×™×›×•×œ×•×ª ×—×©×™×‘×” ××¢×•×œ×•×ª (×¦×™×•×Ÿ 100): ×—×©×™×‘×” ×× ×¨×’×˜×™×ª, ×©×›×œ×ª× ×™×ª ×•×œ×•×’×™×ª. '××œ×š ×‘×¨×¢×™×•× ×•×ª', ×™×›×•×œ×ª ×¢×™×‘×•×“ × ×ª×•× ×™× ×’×‘×•×”×”, ××ª××™× ×œ×ª×¤×§×™×“×™ × ×™×”×•×œ ×•×¢×¦×××•×ª.",
        2: "×—×©×™×‘×” ××¦×•×™× ×ª ×›×©×›×™×¨, ×—×œ×©×” ×›×¢×¦×××™. ××§×©×” ×¢×œ ×–×•×’×™×•×ª (×—×©×™×‘×” ×ª×œ×•×ª×™×ª). ×˜×•×‘ ×‘×œ×™××•×“×™×.",
        3: "×—×©×™×‘×” ×˜×•×‘×•×ª, '××œ×š ×‘×™×¦×™×¨×ª×™×•×ª'. ×¡×’× ×•×Ÿ ×—×©×™×‘×” ××”×™×¨ ××š ×§×•×©×™ ×‘×”×ª××“×” (×‘×¢×™×§×¨ ×‘×–×•×’×™×•×ª). ×× ×¨×’×™×” ×—×‘×¨×•×ª×™×ª ×•× ×˜×™×™×” ×œ×¡×˜×•×¦×™×.",
        4: "××“× ×‘×™×§×•×¨×ª×™ (×›×œ×¤×™ ×¢×¦××• ×•××—×¨×™×), ×¤×¨×¤×§×¦×™×•× ×™×¡×˜. ×—×©×™×‘×” ××¡×•×“×¨×ª ×•×× ×œ×™×˜×™×ª, ×˜×•×‘ ×›×©×›×™×¨ ×•×‘×œ×™××•×“×™×. ×§×©×” ×•× ×•×§×©×”, ×× ×¡×” ×œ×©×œ×•×˜ ×‘×–×•×’×™×•×ª.",
        5: "××œ×š ×‘×ª×§×©×•×¨×ª (×¦×™×•×Ÿ 90), ×—×©×™×‘×” ××¦×•×™× ×ª ×•××”×™×¨×”. × ×˜×™×™×” ×œ×¤×¨×•×¥ ××¡×’×¨×•×ª, ×‘×–×‘×–× ×•×ª ×•× ×”× ×ª× ×•×ª. ×§×œ×™×˜×” ××¦×•×™× ×ª ×œ×©×¤×•×ª.",
        6: "×—×©×™×‘×” ×”×¡×¡× ×™×ª, ×©×•××£ ×œ××™×–×•×Ÿ. ×¢×“×™×£ ×›×©×›×™×¨. ×“×—×£ ×œ×˜×¤×œ ×‘××—×¨×™×, ×¦×•×¨×š ×‘×©×™×ª×•×¤×™×•×ª. ×˜×•×‘×™× ×‘×¡×—×™×˜×” ×¨×’×©×™×ª. ×˜×•×‘ ×œ×–×•×’×™×•×ª.",
        7: "××œ×š ×‘×™×“×¢ ×•×—×•×›××” (×¦×™×•×Ÿ 100), ××š ×¨×’×©×™×ª ×¦×™×•×Ÿ 20. ×”×”×ª× ×”×œ×•×ª ×‘×–×•×’×™×•×ª ××”×¨×’×© (×’×•×¨× ×œ×˜×¢×•×™×•×ª). × ×˜×™×™×” ×œ××—×œ×•×ª × ×¤×© ×•×—×•×¡×¨ ××™×–×•×Ÿ.",
        8: "××œ×š ×‘×ª×›× ×•×Ÿ ×•×‘×™×¦×•×¢. ×—×©×™×‘×” ×”×™×©×’×™×ª, ×ª×›×œ×™×ª×™×ª ×•×× ×œ×™×˜×™×ª. ×œ×•×§×— ×¡×™×›×•× ×™× ××—×•×©×‘×™×. ×™×•×“×¢ ×œ×©×œ×•×˜ ×‘××¡×¤×¨×™× ×§××¨××ª×™×™×. ××¦×•×™×Ÿ ×‘×›×œ ×ª×—×•×.",
        9: "×¨××™×™×” ××¨×—×‘×™×ª ×¨×—×‘×”, ×—×©×™×‘×” ×× ×¨×’×˜×™×ª ×× ×œ×™×˜×™×ª. ×™×›×•×œ×•×ª ×—×©×™×‘×” ×œ×©×›×™×¨ ××¢×•×œ×•×ª. ×—×™×¡×¨×•×Ÿ: ×§×•×©×™ ×‘×’×‘×™×™×ª ×›×¡×£. ××¦×•×™×Ÿ ×‘×–×•×’×™×•×ª.",
        11: "× ×•×˜×” ×œ×”×ª× ×”×œ ×›-2. × ×˜×™×™×” ×œ×’××’×•× ××• ××¤×™×œ×¤×¡×™×”.",
        13: "×—×©×™×‘×” ××¤×•×¦×œ×ª, ×‘×™×§×•×¨×ª×™ ×•× ×•×§×©×” (×›×œ×¤×™ ×¢×¦××• ×•×¡×‘×™×‘×”). ××œ×š ×‘×¨×¢×™×•× ×•×ª ×œ× ×™×©×™××™×. ××“× ×§×™×¦×•× ×™ ×‘×“×¢×•×ª×™×•. ×¡×•×‘×œ ××”×¤×¨×¢×•×ª ×§×©×‘ ×•×¨×™×›×•×– ××•×¨×›×‘×•×ª. ×œ× ××ª××™× ×œ×¢×¦×××™.",
        14: "××™×™×¦×¨ ×‘×¢×™×•×ª ×‘×–×•×’×™×•×ª. ××œ× ×‘×¨×¢×™×•× ×•×ª ×¢×¡×§×™×™× (×œ× ×™×©×™××™×). ×™×›×•×œ×ª ×‘×™×˜×•×™ ××¦×•×™× ×ª ×•×ª×§×©×•×¨×ª×™. × ×˜×™×™×” ×œ×§×—×ª ×¡×™×›×•× ×™× ××¢×‘×¨ ×œ×§×¦×”.",
        16: "×× ×¨×’×™×” ×©××™×™×¦×¨×ª ×‘×¢×™×•×ª ×•×“×•×—×” ×–×•×’×™×•×ª. ××œ×š ×‘×¢×¦×•×ª ×œ××—×¨×™× (×œ× ×œ×¢×¦××•) ×•×‘×¨×¢×™×•× ×•×ª ×œ× ×™×©×™××™×. ×¤×¨×™×§ ×©×œ×™×˜×”, ×‘×™×§×•×¨×ª×™ ×•×¦×™× ×™. × ×˜×™×™×” ×œ×¤×©×™×˜×•×ª ×¨×’×œ ×›×¢×¦×××™.",
        19: "×× ×¡×” ×œ×©×œ×•×˜ ×‘×× ×©×™× ××—×¨×™×. × ×•×˜×” ×œ×§×•×¨×‘× ×•×ª ××• ××§×¨×‘×Ÿ. ×—×©×™×‘×” ×•×‘×™×˜×•×™ ×‘×™× ×•× ×™×™×.",
        22: "× ×•×˜×” ×œ×”×ª× ×”×œ ×›-4 (×‘×™×§×•×¨×ª×™, ××¡×•×“×¨).",
        33: "× ×•×˜×” ×œ×”×ª× ×”×œ ×›-6, ××š ×—×–×§ ×™×•×ª×¨ ×‘×”×ª××“×”."
    },
    # ×”×•×ª×× ×'×¦'××§×¨×ª ×”×¢×™×Ÿ ×”×©×œ×™×©×™×ª'
    '×ª×“×¨ ×”×ª×ª ××•×“×¢': { 
        7: "×× ×¨×’×™×” ×©××™×™×¦×¨×ª ×‘×¢×™×•×ª ×‘×–×•×’×™×•×ª, ×—×¨×“×•×ª ×•×”×¤×¡×“×™× ×›×¡×¤×™×™×.",
        13: "×”×•×¤×š ××ª ×”××“× ×œ×§×©×” ×•× ×•×§×©×”, ×©×”×›×œ ×¦×¨×™×š ×œ×”×™×•×ª ××š ×•×¨×§ ×‘×“×¨×š ×©×œ×•.",
        14: "×× ×¨×’×™×” ×”××•×©×›×ª ×–×•×’×™×•×ª ××š ×× ×¡×” ×œ×¤×¨×§ ××•×ª×” ×‘×›×œ ×¨×’×¢ ××¤×©×¨×™. ×‘× ×” ×œ×¢×¦××• ×¢×ª×™×“ ×œ×œ× ×›×¡×£, ×–×•×’×™×•×ª ××• ××¢×¨×›×•×ª ×™×—×¡×™×.",
        16: "×”××“× ×‘× ×” ×œ×¢×¦××• ×¢×ª×™×“ ×¢× ×‘×¢×™×•×ª ×‘×–×•×’×™×•×ª, ×”×¤×¡×“×™× ×›×¡×¤×™×™×, ×‘×¢×™×•×ª × ×¤×©×™×•×ª, ×—×¨×“×•×ª ×•×“×™×›××•× ×•×ª (×× ×™×” ×“×™×¤×¨×¡×™×”).",
        19: "×‘×—×•×•×™×” ×”×¤× ×™××™×ª ×¢×‘×¨ ××™×¨×•×¢ ×˜×¨××•××˜×™. ×™×•×¦×¨ ×œ×¢×¦××• ×¢×ª×™×“ ×§×•×¨×‘× ×™, ×—×•×¡×¨ ×‘×™×˜×—×•×Ÿ ×¢×¦××™, ×‘×¢×™×•×ª ×§×©×‘ ×•×¨×™×›×•×– ×•× ×˜×™×™×” ×œ×”×ª××›×¨×•×™×•×ª.",
        1: "×ª×ª ××•×“×¢ ×˜×•×‘ ×©××§×“× ××ª ×”××“×.", 
        2: "×ª×ª ××•×“×¢ ×—×œ×©, ×ª×œ×•×ª×™, ××—×¤×© ×–×•×’×™×•×ª ×•××™×©×•×¨ ××”×¡×‘×™×‘×”.",
        3: "×ª×ª ××•×“×¢ ×§×œ×™×œ, ××§×“× ×©××—×ª ×—×™×™× ×•×—×•×¤×©.",
        4: "×ª×ª ××•×“×¢ ×™×¦×™×‘, ××¢×“×™×£ ××¡×’×¨×•×ª ×•×¡×“×¨.",
        5: "×ª×ª ××•×“×¢ ×ª×§×©×•×¨×ª×™, ××§×“× ×’×‘×•×œ×•×ª ×•××™× ×™×•×ª.",
        6: "×ª×ª ××•×“×¢ ××©×¤×—×ª×™, ××§×“× × ×ª×™× ×” ×•×˜×™×¤×•×œ ×‘××—×¨×™×.",
        8: "×ª×ª ××•×“×¢ ×”×™×©×’×™, ×“×•×—×£ ×œ× ×™×”×•×œ ×•×œ×¢×¦×××•×ª.",
        9: "×ª×ª ××•×“×¢ ×¨×•×—× ×™, ×“×•×—×£ ×œ×”× ×”×’×” ×•×œ×§×™×“×•× ×”×× ×•×©×•×ª.",
        11: "×ª×ª ××•×“×¢ ×××¡×˜×¨, ×“×•×—×£ ×œ×˜×™×¤×•×œ ×‘××—×¨×™× ×•×œ×¤×™×ª×•×— ××™×©×™."
    },
    # ×”×•×ª×× ×'×¦'××§×¨×ª ×”×›×ª×¨'
    '×ª×“×¨ ×”×ª×©×•×§×”': { 
        1: "×™×•× ×œ×™×“×” ×—×–×§: ×¢×•×–×¨ ×œ×”×ª×§×“× ×‘×—×™×™× (×‘××™×•×—×“ ×‘×©×™× 2 ×•-3). ×”×¢×•×œ× ××–××Ÿ ×”×–×“×× ×•×™×•×ª ×œ× ×™×”×•×œ ×•×œ×§×™×“×•× ×¢×¡×§×™.",
        2: "×™×•× ×œ×™×“×” ××¢×›×‘: ××¢×›×‘ ×‘×ª×—×•××™× ×©×œ ×–×•×’×™×•×ª, ×©×™×ª×•×¤×™ ×¤×¢×•×œ×” ×•×§×•×©×™ ×‘×¢×¡×§×™× (×œ× ××©×¤×™×¢ ×œ×¨×¢×” ×›×©×›×™×¨).",
        3: "×™×•× ×œ×™×“×” ××¦×•×™×Ÿ: ××©×™×›×” ×œ×¡×¤×•×¨×˜, ××•×–×™×§×” ×•××•×× ×•×ª. × ×˜×™×™×” ×œ×”×™×•×ª ×¢×¦×××™.",
        4: "×™×•× ×œ×™×“×” ×™×¦×™×‘: ×”×™×§×•× ××–××Ÿ ×”×–×“×× ×•×™×•×ª ×œ×¨×›×™×©×ª × ×“×œ\"×Ÿ ×•× ×›×¡×™× (×‘×©×™× 2 ×•-3). ×™×•× ×œ×™×“×” ××¦×•×™×Ÿ ×œ×©×›×™×¨×™×, ×—×œ×© ×™×—×¡×™×ª ×œ×¢×¡×§×™×.",
        5: "×™×•× ×œ×™×“×” ××¦×•×™×Ÿ: ×“×•××” ×œ-3, ×¢× ×× ×¨×’×™×” × ×•×¡×¤×ª ×©×œ ××—×©×‘×™×, ××™× ×˜×¨× ×˜ ×•×¨××™×™×ª ×—×©×‘×•×Ÿ. ×× ×©×™× ××™× ×™×™× ×¢× ×ª×§×©×•×¨×ª ×˜×•×‘×”.",
        6: "×™×•× ×œ×™×“×” ×¤×¨×•×•×”: ×œ× ×¢×•×–×¨ ×•×œ× ××•× ×¢. ×”×™×§×•× ×¢×•×–×¨ ×œ×”×§×™× ××©×¤×—×”.",
        7: "×™×•× ×œ×™×“×” ××¢×›×‘: ××©×¤×™×¢ ×œ×¨×¢×” ×”×—×œ ××”×©×™× ×”×©× ×™. ×”×›×œ ×”×•×œ×š ×™×•×ª×¨ ×§×©×”, ×××•×¤×™×™×Ÿ ×‘×”×¨×‘×” ×—×¨×“×•×ª ×•×§×¨×™×¡×•×ª × ×¤×©×™×•×ª. ×™×›×•×œ ×œ×”×¦×œ×™×— ×‘×¡×¤×•×¨×˜.",
        8: "×™×•× ×œ×™×“×” ××¦×•×™×Ÿ: ×“×•×—×£ ×œ×¢×¦×××•×ª ×•× ×™×”×•×œ. ×˜×¨×™×§×™: ×¢×œ×•×œ ×œ×”×¡×ª×‘×š ×¢× ×›×¡×¤×™× ×•×¨×©×•×™×•×ª (×œ×¢×¦×××™×).",
        9: "×™×•× ×œ×™×“×” ×—×–×§: ××™×™×¦×¨ ×ª×”×¤×•×›×•×ª ×‘×’×™×œ 2 ×•-3. ×× ×”××“× ×™×•×“×¢ ×œ×”×ª××•×“×“, ×”×ª×”×¤×•×›×•×ª ×™×§×“××• ××•×ª×•.",
        11: "×™×•× ×œ×™×“×” ×—×–×§: × ×˜×™×™×” ×œ×—×¨×“×•×ª ×•×§×¨×™×¡×•×ª × ×¤×©×™×•×ª ×œ×œ× ××¤×” ×—×–×§×”. ×“×•×—×£ ×œ×”××¦××•×ª ×¨×•×—× ×™×•×ª.",
        13: f"×§×¨××” ×—×•× ×§×ª. ××’×™×¢ ×œ×©×™× ×‘×©×™× 2 ×•-3. ××•×©×š ×œ×˜×™×¤×•×œ. {KARMIC_WARNING}",
        14: f"×›××• 13: ×‘×¢×™×” ×‘××¡×’×¨×•×ª ×•××¢×¨×›×•×ª ×™×—×¡×™×. {KARMIC_WARNING}",
        16: f"×›××• 13: ×§××¨××” ××¢×›×‘×ª ×¨×•×—× ×™×ª, ××©×¤×™×¢ ×¢×œ ×”× ×¤×©. {KARMIC_WARNING}",
        19: f"×›××• 13: ×§××¨××” ××¢×›×‘×ª ×§×•×¨×‘× ×™×ª. ×™×© ×œ×”×™×–×”×¨ ×©×œ× ×œ×”×™×›× ×¡ ×œ×›×œ× ×‘×ª×§×•×¤×” ×–×•. {KARMIC_WARNING}",
        22: "×™×•× ×œ×™×“×” ×—×–×§: ×“×•×—×£ ×§×“×™××”. ×™×© ×œ×• ××ª ×”×××¡×˜×¨ ×”×—×–×§ ×‘×™×•×ª×¨ (×œ×”××¦××•×ª ×•×—×™×“×•×©×™×). ×× × ×•×¤×œ, ×¦×¨×™×š ×œ×”×ª×¨×•×× ×œ×‘×“.",
        33: "×™×•× ×œ×™×“×” ×—×–×§: ×ª×•××š ×‘×‘× ×™×™×ª ××©×¤×—×” ×™×¦×™×‘×”."
    },
    # ×”×•×ª×× ×'×¦'××§×¨×ª ×”×™×§×•×'
    '×ª×“×¨ ××–×œ ××¡×˜×¨×•×œ×•×’×™': { 
        1: "××–×œ ××¨×™×” (××¦×•×™×Ÿ): ×“×•×—×£ ×§×“×™××”, ×›×¨×™×–××˜×™, ××œ×š ×‘×¨×¢×™×•× ×•×ª ×•×‘×‘×™×¦×•×¢. ×˜×•×‘ ×‘×ª×¤×§×™×“×™ × ×™×”×•×œ.",
        2: "××–×œ ×¡×¨×˜×Ÿ (××¢×›×‘): ×¦×¨×™×š ××¤×” ×—×–×§×” ×›×“×™ ×œ×”×ª×§×“×. ×× ×©×™× ×ª×œ×•×ª×™×™×, ×˜×•×‘×™× ×›×©×›×™×¨×™×, ×—×œ×©×™× ×›×¢×¦×××™×.",
        3: "××–×œ ×§×©×ª (××¦×•×™×Ÿ): ×“×•×—×£ ×§×“×™××” ×œ×”×™×•×ª ×¢×¦×××™. ××©×™×›×” ×œ×¡×¤×•×¨×˜, ××•×–×™×§×” ×•××•×× ×•×ª.",
        4: "××–×œ ×‘×ª×•×œ×” (×™×¦×™×‘): ×˜×•×‘ ×××•×“ ×‘××¡×’×¨×•×ª.",
        5: "××–×œ ×ª××•××™× (××¦×•×™×Ÿ): ×“×•×—×£ ×§×“×™××”, ×—×–×§ ×‘×ª×§×©×•×¨×ª. ×”×ª××—×•×™×•×ª ×‘×¡×¤×•×¨×˜, ××—×©×‘×™× ×•××™× ×˜×¨× ×˜.",
        6: "××–×œ ×××–× ×™×™× (×¤×¨×•×•×”): ×˜×•×‘ ×œ×¤×•×œ×™×˜×™×§×” ×•×œ××©×¤×—×ª×™×•×ª.",
        7: "××–×œ ×“×’×™× (××¢×›×‘): ××™×™×¦×¨ ×§×©×™×™×. 100 ×‘×©×›×œ, 20 ×‘×¨×’×© (× ×˜×™×™×” ×œ×¤×¢×•×œ ××”×¨×’×©).",
        8: "××–×œ ×’×“×™ (××¦×•×™×Ÿ): ×“×•×—×£ ×§×“×™××”, ××š ×¢×œ×•×œ ×œ×”×¤×•×š ×× ×©×™× ×œ××ª×•×¡×›×œ×™× ×¤× ×™××™×ª ×× ×œ× ××¦×œ×™×—×™× ×œ×××© ××ª ×”×¤×•×˜× ×¦×™××œ ×”×’×‘×•×”.",
        9: "××–×œ ×˜×œ×” (××¦×•×™×Ÿ): ×“×•×—×£ ×§×“×™××”, ××ª××™× ×œ×¢×¦×××™×. ××™××¤×•×œ×¡×™×‘×™ (×œ× ×ª××™×“ ××¡×™×™×).",
        11: "××–×œ ×“×œ×™ (××¢×›×‘): × ×§×¨× ××–×œ ×¡×¤×•× ×’'×”, ××ª×§×©×” ×œ×”×’×™×¢ ×œ×“×¨×’×ª ×××¡×˜×¨. ×—×™×™×‘ ××¤×” ×—×–×§×”.",
        22: "××–×œ ×¢×§×¨×‘ (×”×—×–×§ ×‘×™×•×ª×¨): ×“×•×—×£ ×§×“×™××” ×××•×“ ×—×–×§. ×™×™×¢×•×“ ×’×‘×•×” ×œ×”×©××™×¨ ×—×•×ª×, ×œ×”×‘×™× ×”××¦××•×ª ×œ×¢×•×œ×. ×™×•×¦×¨ ×‘×™×˜×—×•×Ÿ ×¢×¦××™ ×—×–×§.",
        33: "××–×œ ×©×•×¨ (×˜×•×‘): ××–×œ ×™×¦×™×‘, ×˜×•×‘ ×œ××©×¤×—×”. × ×˜×™×™×” ×œ×©×œ×™×˜×” ×‘××¢×¨×›×•×ª ×™×—×¡×™×."
    }
}

# ××¤×ª ×¦×‘×¢×™× ×¡×•×¤×™×ª
COLOR_MAP_HTML = {
    'â­ ×ª×“×¨ ×××¡×˜×¨': '#DC143C',     # ××“×•× (MASTER)
    'âš ï¸ ×ª×“×¨ ×—×œ×©/××¢×›×‘': '#0000FF',  # ×›×—×•×œ (WEAK: 2, 7)
    'âŒ ×ª×“×¨ ×§××¨××ª×™': '#A9A9A9',    # ××¤×•×¨ (KARMIC: 13, 14, 16, 19)
    'âœ… ×ª×“×¨ ×—×–×§': '#FFFF00',       # ×¦×”×•×‘ (STRONG)
    'â– ×ª×“×¨ ×××•×–×Ÿ': '#F0F2F6',     # ××¤×•×¨ ×‘×”×™×¨ (MEDIUM/NEUTRAL)
    'âšª ××ª×’×¨ ×—×–×§ ×‘××™×•×—×“': '#C0C0C0' # ××¤×•×¨ ××ª×›×ª×™
}


# 2. ×¤×•× ×§×¦×™×•×ª ×¢×–×¨ ×•×¦××¦×•× 
# ------------------------------------------------
def reduce_number(n, special_rules=True, reduce_all=False):
    """××¦××¦× ××¡×¤×¨. special_rules=True ×©×•××¨ ×¢×œ ×××¡×˜×¨×™× ×•×§××¨××”. reduce_all=True ×ª××™×“ ××¦××¦× ×œ×—×“-×¡×¤×¨×ª×™."""
    if special_rules:
        if n in ALL_MASTER_NUMBERS or n in KARMIC_NUMBERS:
            return n
            
    if reduce_all:
        while n > 9:
            n = sum(int(digit) for digit in str(n))
        return n
    
    # ×¦××¦×•× ×¨×’×™×œ (×©×•××¨ ×××¡×˜×¨×™× ××¢×œ 9 ×©××™× × 11, 22, 33)
    while n > 9 and n not in SPECIAL_NUMBERS:
        n = sum(int(digit) for digit in str(n))
    return n

def calculate_name_sum(name_part, letters_map, return_unreduced=False):
    """××—×©×‘ ×¡×›×•× ×’×™××˜×¨×™ ×œ×—×œ×§ × ×ª×•×Ÿ ×©×œ ×”×©×."""
    total = 0
    name_part = name_part.replace(" ", "")
    for char in name_part:
        if char in letters_map:
            total += letters_map[char]
    if return_unreduced: return total
    return reduce_number(total, special_rules=True)

# 3. ×—×™×©×•×‘ ×ª××¨×™×š ×œ×™×“×” ×•×ª×“×¨×™× ×“×™× ××™×™×
# ------------------------------------------------
def get_astro_sign(day, month):
    """××—×©×‘ ××ª ×”××–×œ ×”××¡×˜×¨×•×œ×•×’×™ ×¢×œ ×‘×¡×™×¡ ×™×•× ×•×—×•×“×© ×•××—×–×™×¨ ××ª ×©× ×”××–×œ."""
    if (month == 3 and day >= 21) or (month == 4 and day <= 19): return '×˜×œ×”'
    if (month == 4 and day >= 20) or (month == 5 and day <= 20): return '×©×•×¨'
    if (month == 5 and day >= 21) or (month == 6 and day <= 20): return '×ª××•××™×'
    if (month == 6 and day >= 21) or (month == 7 and day <= 22): return '×¡×¨×˜×Ÿ'
    if (month == 7 and day >= 23) or (month == 8 and day <= 22): return '××¨×™×”'
    if (month == 8 and day >= 23) or (month == 9 and day <= 22): return '×‘×ª×•×œ×”'
    if (month == 9 and day >= 23) or (month == 10 and day <= 22): return '×××–× ×™×™×'
    if (month == 10 and day >= 23) or (month == 11 and day <= 21): return '×¢×§×¨×‘'
    if (month == 11 and day >= 22) or (month == 12 and day <= 21): return '×§×©×ª'
    if (month == 12 and day >= 22) or (month == 1 and day <= 19): return '×’×“×™'
    if (month == 1 and day >= 20) or (month == 2 and day <= 18): return '×“×œ×™'
    if (month == 2 and day >= 19) or (month == 3 and day <= 20): return '×“×’×™×'
    return '×œ× × ××¦×' 

def calculate_birth_data(day, month, year):
    """××—×©×‘ ××ª ×ª×“×¨×™ ×”×œ×™×“×” ×”×¨××©×™×™× (×ª×©×•×§×”, ×™×™×¢×•×“, ××¡×˜×¨×•×œ×•×’×™)."""
    day_reduced = reduce_number(day, special_rules=True)
    
    # ×¦××¦×•× ×—×•×“×©×™× ××™×•×—×“ 10->1, 12->3, 11 × ×©××¨ 11
    if month == 10:
        month_val = 1
    elif month == 12:
        month_val = 3
    elif month == 11:
        month_val = 11
    else:
        month_val = month

    month_reduced = reduce_number(month_val, special_rules=True)
    year_reduced = reduce_number(year, special_rules=True) # ×©× ×” ××¦×•××¦××ª (×©×•××¨ ×××¡×˜×¨/×§××¨××”)
    year_reduced_single = reduce_number(year, reduce_all=True)
    destiny_number = reduce_number(day_reduced + month_reduced + year_reduced, special_rules=True)
    astro_sign = get_astro_sign(day, month)
    astro_number = ASTRO_MAP.get(astro_sign, None)
    
    return day_reduced, month_val, month_reduced, year_reduced, year_reduced_single, destiny_number, astro_number, astro_sign

# ğŸš¨ ×¤×•× ×§×¦×™×•×ª ×—×“×©×•×ª: ×—×™×©×•×‘ ×ª×“×¨×™× ××™×©×™×™×
def calculate_personal_year(day_of_birth, month_of_birth, year_of_birth, current_date):
    """
    ××—×©×‘ ××ª ×ª×“×¨ ×”×©× ×” ×”××™×©×™×ª, ×œ×¤×™ ×›×œ×œ×™ ×”×¦××¦×•× (×©×•××¨ ×××¡×˜×¨/×§××¨××”) 
    ×•×”×‘×“×™×§×” ×× ×™×•× ×”×”×•×œ×“×ª ×‘×©× ×” ×”× ×•×›×—×™×ª ×›×‘×¨ ×¢×‘×¨.
    """
    
    # ×¦××¦×•× ×™×•× ×•×—×•×“×© ×œ×™×“×” (×©×•××¨ ×××¡×˜×¨/×§××¨××”)
    D = reduce_number(day_of_birth, special_rules=True)
    
    M_val = month_of_birth
    if month_of_birth == 10: M_val = 1
    elif month_of_birth == 12: M_val = 3
    M = reduce_number(M_val, special_rules=True)

    # ×‘×“×™×§×” ×”×× ×™×•× ×”×”×•×œ×“×ª ×›×‘×¨ ×¢×‘×¨ ×‘×©× ×” ×”× ×•×›×—×™×ª (current_date)
    has_birthday_passed = (
        current_date.month > month_of_birth or 
        (current_date.month == month_of_birth and current_date.day >= day_of_birth)
    )

    if has_birthday_passed:
        # ×™×•× ×”×•×œ×“×ª ×›×‘×¨ ×¢×‘×¨ - ××©×ª××©×™× ×‘×©× ×” ×”× ×•×›×—×™×ª
        year_to_use = current_date.year
    else:
        # ×™×•× ×”×•×œ×“×ª ×˜×¨× ×¢×‘×¨ - ××©×ª××©×™× ×‘×©× ×” ×§×•×“××ª
        year_to_use = current_date.year - 1

    # ×¦××¦×•× ×¢×¨×š ×”×©× ×” (×©×•××¨ ×××¡×˜×¨/×§××¨××”)
    Y = reduce_number(year_to_use, special_rules=True)
    
    # ×—×™×©×•×‘ ×ª×“×¨ ×”×©× ×” ×”××™×©×™×ª: ×™×•× + ×—×•×“×© + ×©× ×”
    personal_year_sum = D + M + Y
    personal_year_freq = reduce_number(personal_year_sum, special_rules=True)
    
    return personal_year_freq, year_to_use

def calculate_personal_cycles(day_of_birth, month_of_birth, year_of_birth, current_date):
    """
    ××—×©×‘ ××ª ×ª×“×¨×™ ×”×©× ×”, ×”×—×•×“×© ×•×”×™×•× ×”××™×©×™×™×.
    """
    
    # 1. ×ª×“×¨ ×”×©× ×” ×”××™×©×™×ª
    py_freq, py_year = calculate_personal_year(day_of_birth, month_of_birth, year_of_birth, current_date)
    
    # 2. ×ª×“×¨ ×”×—×•×“×© ×”××™×©×™
    current_month_val = current_date.month
    M_current_reduced = reduce_number(current_month_val, special_rules=True) 
    
    personal_month_sum = py_freq + M_current_reduced
    personal_month_freq = reduce_number(personal_month_sum, special_rules=True)
    
    # 3. ×ª×“×¨ ×”×™×•× ×”××™×©×™
    current_day_val = current_date.day
    D_current_reduced = reduce_number(current_day_val, special_rules=True)
    
    personal_day_sum = personal_month_freq + D_current_reduced
    personal_day_freq = reduce_number(personal_day_sum, special_rules=True)
    
    return py_freq, personal_month_freq, personal_day_freq, py_year

# 4. ×—×™×©×•×‘ ×ª×“×¨×™ ×©×
# ------------------------------------------------
def calculate_name_freqs(first_name, last_name, destiny_number):
    """××—×©×‘ ××ª ×›×œ ×ª×“×¨×™ ×”×©× ×•×”×¦'××§×¨×•×ª ×”× ×œ×•×•×ª."""
    all_letters_map = GIMATRIA_MAP 
    
    # ×—×™×©×•×‘ ×¡×›×•××™× ×œ× ××•×¤×—×ª×™×
    fn_all_sum_unreduced = calculate_name_sum(first_name, all_letters_map, return_unreduced=True)
    ln_all_sum_unreduced = calculate_name_sum(last_name, all_letters_map, return_unreduced=True)
    consonants_map = {k: v for k, v in all_letters_map.items() if k in CONSONANTS}
    fn_consonants_sum_unreduced = calculate_name_sum(first_name, consonants_map, return_unreduced=True)
    ln_consonants_sum_unreduced = calculate_name_sum(last_name, consonants_map, return_unreduced=True)
    fn_vowels_sum_unreduced = calculate_name_sum(first_name, VOWELS_MAP, return_unreduced=True) 
    ln_vowels_sum_unreduced = calculate_name_sum(last_name, VOWELS_MAP, return_unreduced=True)
    
    # ×¦××¦×•× ×—×œ×§×™
    fn_reduced = reduce_number(fn_all_sum_unreduced, special_rules=True)
    ln_reduced = reduce_number(ln_all_sum_unreduced, special_rules=True)
    fn_consonants_reduced = reduce_number(fn_consonants_sum_unreduced, special_rules=True)
    ln_consonants_reduced = reduce_number(ln_consonants_sum_unreduced, special_rules=True)
    fn_vowels_reduced = reduce_number(fn_vowels_sum_unreduced, special_rules=True)
    ln_vowels_reduced = reduce_number(ln_vowels_sum_unreduced, special_rules=True)
    
    # 1. ×ª×“×¨ ×”×©× (×¦'××§×¨×ª ×”×¢×œ)
    name_freq_full = fn_reduced
    
    # 2. ×ª×“×¨ ×ª×¢×¡×•×§×” (×¦'××§×¨×ª ×”××™×Ÿ ×•×”×™×¦×™×¨×”)
    career_freq = reduce_number(fn_reduced + ln_reduced, special_rules=True) 
    
    # 3. ×ª×“×¨ ×¡×‘×™×‘×ª×™ (×¦'××§×¨×ª ×”×‘×¡×™×¡)
    env_freq = reduce_number(fn_consonants_reduced + ln_consonants_reduced, special_rules=True)
    
    # 4. ×ª×“×¨ ×—×©×™×‘×” ×•×‘×™×˜×•×™ (×¦'××§×¨×ª ×”×’×¨×•×Ÿ)
    exp_freq = reduce_number(fn_vowels_reduced + ln_vowels_reduced, special_rules=True)

    # 5. ×ª×“×¨ ×ª×ª ××•×“×¢ (×¦'××§×¨×ª ×”×¢×™×Ÿ ×”×©×œ×™×©×™×ª)
    subconscious_freq = reduce_number(destiny_number + career_freq, special_rules=True)
    
    # 6. ×ª×“×¨ ×—×•×¡×¨ (×¦'××§×¨×ª ×”×œ×‘)
    destiny_for_lack = reduce_number(destiny_number, reduce_all=True) 
    career_for_lack = reduce_number(career_freq, reduce_all=True) 
    lack_freq = abs(destiny_for_lack - career_for_lack)
    
    return {
        '×ª×“×¨ ×¡×‘×™×‘×ª×™': env_freq, '×ª×“×¨ ×ª×¢×¡×•×§×”': career_freq, '×ª×“×¨ ×”×—×•×¡×¨': lack_freq,
        '×ª×“×¨ ×”×‘×™×˜×•×™ ×•×”×—×©×™×‘×”': exp_freq, '×ª×“×¨ ×”×ª×ª ××•×“×¢': subconscious_freq, '×ª×“×¨ ×”×©×': name_freq_full
    }

# 5. ×—×™×©×•×‘ ××—×–×•×¨×™ ×—×™×™× (P, W)
# ------------------------------------------------
def calculate_life_cycles(day_reduced, month_val, year_reduced, destiny_number):
    """××—×©×‘ ××ª 4 ××—×–×•×¨×™ ×”×—×™×™× (P - ×× ×¨×’×™×” ×¨××©×™×ª) ×•××ª ×¨×¦×•×Ÿ ×”×™×§×•×/××ª×’×¨×™× (W)."""
    
    D = day_reduced
    M_p = reduce_number(month_val, special_rules=True)
    Y_p = year_reduced # ×©× ×” ××¦×•××¦××ª (×©×•××¨ ×××¡×˜×¨/×§××¨××”)

    # ×¢×¨×›×™× ××¦×•××¦××™× ×œ×¡×¤×¨×” ×‘×•×“×“×ª (×œ×¦×•×¨×š ×—×™×©×•×‘ ×”××ª×’×¨×™×)
    M_w = reduce_number(month_val, reduce_all=True) 
    D_w = reduce_number(D, reduce_all=True) 
    Y_w = reduce_number(year_reduced, reduce_all=True) 
    
    # ×× ×¨×’×™×” ×¨××©×™×ª (P)
    p1 = reduce_number(M_p + D, special_rules=True) 
    p2 = reduce_number(D + Y_p, special_rules=True)
    p3 = reduce_number(p1 + p2, special_rules=True)
    p4 = reduce_number(M_p + Y_p, special_rules=True)
    
    # ×¨×¦×•×Ÿ ×”×™×§×•×/××ª×’×¨×™× (W) - ×ª××™×“ ×—×“-×¡×¤×¨×ª×™
    w1_val = abs(M_w - D_w); w1 = reduce_number(w1_val, reduce_all=True)
    w2_val = abs(D_w - Y_w); w2 = reduce_number(w2_val, reduce_all=True)
    w3_val = abs(w1 - w2); w3 = reduce_number(w3_val, reduce_all=True)
    w4_val = abs(M_w - Y_w); w4 = reduce_number(w4_val, reduce_all=True)
    
    # ×× ×¨×’×™×” ××©× ×™×ª (M - ×”××ª× ×•×ª)
    m1 = M_p 
    m2 = D 
    m3 = D 
    m4 = Y_p 
    
    cycles = {'1': {'××©× ×™×ª': m1, '×¨××©×™×ª': p1, '×™×§×•×': w1}, 
              '2': {'××©× ×™×ª': m2, '×¨××©×™×ª': p2, '×™×§×•×': w2}, 
              '3': {'××©× ×™×ª': m3, '×¨××©×™×ª': p3, '×™×§×•×': w3}, 
              '4': {'××©× ×™×ª': m4, '×¨××©×™×ª': p4, '×™×§×•×': w4}}
    
    # ×—×™×©×•×‘ ×ª×§×•×¤×•×ª ×—×™×™× (Periods)
    A = reduce_number(destiny_number, reduce_all=True) 
    end1 = 37 - A
    periods = {
        '1': f"0-{end1}",
        '2': f"{end1}-{end1 + 9}",
        '3': f"{end1 + 9}-{end1 + 18}",
        '4': f"{end1 + 18}-120"
    }
    return cycles, periods

# 6. ×™×¦×™×¨×ª ×˜×§×¡×˜ ×¢×•×¦××” ×•-DataFrames
# ------------------------------------------------
def get_strength_text(freq_name, freq_value, astro_sign=None):
    """××—×–×™×¨×” ××ª ×˜×§×¡×˜ ×”×¢×•×¦××” ×¢×œ ×‘×¡×™×¡ ×¢×¨×š ×”×ª×“×¨."""
    is_master = freq_value in ALL_MASTER_NUMBERS
    is_karmic = freq_value in KARMIC_NUMBERS
    
    def get_key(key):
        return STRENGTH_TEXT_MAP.get(key, 'â– ×ª×“×¨ ×××•×–×Ÿ')

    if is_karmic: return get_key('KARMIC')
    if is_master: return get_key('MASTER')
    
    # ×”×’×“×¨×•×ª ×›×œ×œ×™×•×ª ×œ×ª×“×¨×™× ××™×©×™×™× (×”×•×ª×× ×›×“×™ ×œ×¢×‘×•×“ ×’× ×¢×œ ×ª×“×¨×™× ×“×™× ××™×™×)
    if freq_name in {'×× ×¨×’×™×” ×¨××©×™×ª', '×ª×“×¨ ×”×™×™×¢×•×“ (×©×‘×™×œ ×”×’×•×¨×œ)', '×ª×“×¨ ×”×ª×©×•×§×” (×™×•× ×”×œ×™×“×”)', '×ª×“×¨ ×¡×‘×™×‘×ª×™', '×ª×“×¨ ×ª×¢×¡×•×§×”', '×ª×“×¨ ×”×‘×™×˜×•×™ ×•×”×—×©×™×‘×”', '×ª×“×¨ ×”×ª×ª ××•×“×¢', '×ª×“×¨ ×”×©×', '×©× ×” ××™×©×™×ª', '×—×•×“×© ××™×©×™', '×™×•× ××™×©×™'}:
        if freq_value in {1, 5, 8, 9}: return get_key('STRONG')
        if freq_value in {2, 7}: return get_key('WEAK')
        if freq_value in {3, 4, 6}: return get_key('MEDIUM')

    if freq_name in {'×¨×¦×•×Ÿ ×”×™×§×•×', '×ª×“×¨ ×”×—×•×¡×¨'}:
        if freq_value == 0: return 'âšª ××ª×’×¨ ×—×–×§ ×‘××™×•×—×“'
        if freq_value in {1, 3, 5, 8, 9}: return get_key('STRONG')
        if freq_value in {2, 4, 6, 7}: return get_key('WEAK')
        
    if freq_name == '×ª×“×¨ ××–×œ ××¡×˜×¨×•×œ×•×’×™':
        if astro_sign in {'×¢×§×¨×‘', '×©×•×¨'}: return get_key('MASTER')
        if astro_sign in {'×˜×œ×”', '××¨×™×”', '×’×“×™', '×ª××•××™×', '×§×©×ª'}: return get_key('STRONG')
        if astro_sign in {'×××–× ×™×™×', '×‘×ª×•×œ×”'}: return get_key('MEDIUM')
        if astro_sign in {'×¡×¨×˜×Ÿ', '×“×’×™×', '×“×œ×™'}: return get_key('WEAK')
        return get_key('NEUTRAL')
        
    return get_key('NEUTRAL')

def get_chakra_description_text(freq_value, chakra_name):
    """××—×–×™×¨×” ×ª×™××•×¨ ××™×œ×•×œ×™ ×¢×œ ×‘×¡×™×¡ ×ª×“×¨ ×”×¦'××§×¨×” ×•×©××” ×”×—×“×©."""
    
    description_map = CHAKRA_ANALYSIS.get(chakra_name) 
    
    if description_map and freq_value in description_map:
        return description_map[freq_value]
    
    if chakra_name == '×ª×“×¨ ×”×—×•×¡×¨' and freq_value == 0:
        return CHAKRA_ANALYSIS['×ª×“×¨ ×”×—×•×¡×¨'][0]
    
    if chakra_name == '×ª×“×¨ ××–×œ ××¡×˜×¨×•×œ×•×’×™' and freq_value is not None:
         return f"×ª×“×¨ ××–×œ ××¡×˜×¨×•×œ×•×’×™ ({freq_value}) ×œ× ××•×’×“×¨ ×‘××™×œ×•×Ÿ ×”× ×™×ª×•×— ×”××™×œ×•×œ×™."
    
    return f"×œ× × ××¦× × ×™×ª×•×— ××™×œ×•×œ×™ ××“×•×™×§ (×ª×“×¨ {freq_value}) ×¢×‘×•×¨ {chakra_name}."

# 7. ×¤×•× ×§×¦×™×™×ª ×”×¤×¢×œ×” ×¨××©×™×ª
# ----------------------------------------------------

def run_numerology_tool(day, month, year, first_name, last_name, current_date): # ğŸš¨ ×”×•×¡×¤×ª current_date
    """××¨×™×¥ ××ª ×›×œ ×”×—×™×©×•×‘×™× ×•××—×–×™×¨ ××ª ×”-DataFrames ×œ×ª×¦×•×’×” ×‘-Streamlit."""
    
    day_reduced, month_val, month_reduced, year_reduced, year_reduced_single, destiny_number, astro_number, astro_sign = \
        calculate_birth_data(day, month, year)
    
    # ğŸš¨ ×—×™×©×•×‘ ×”×ª×“×¨×™× ×”××™×©×™×™× ×”×—×“×©×™×
    py_freq, pm_freq, pd_freq, py_year = calculate_personal_cycles(day, month, year, current_date)
    
    # 1. ××—×–×•×¨×™ ×—×™×™×
    cycles, periods = calculate_life_cycles(day_reduced, month_val, year_reduced, destiny_number)
    cycle_data = []
    
    for cycle, values in cycles.items():
        period = periods[cycle]
        
        # ×—×™×©×•×‘ ×¢×•×¦××•×ª ×œ×›×œ ×¢××•×“×”
        m_strength = get_strength_text('×× ×¨×’×™×” ××©× ×™×ª', values['××©× ×™×ª']) 
        p_strength = get_strength_text('×× ×¨×’×™×” ×¨××©×™×ª', values['×¨××©×™×ª'])
        w_strength = get_strength_text('×¨×¦×•×Ÿ ×”×™×§×•×', values['×™×§×•×'])

        cycle_data.append([
            f"××—×–×•×¨ {cycle}", period, 
            f"{values['××©× ×™×ª']} ({m_strength})", # ×× ×¨×’×™×” ××©× ×™×ª
            f"{values['×¨××©×™×ª']} ({p_strength})", # ×× ×¨×’×™×” ×¨××©×™×ª
            f"{values['×™×§×•×']} ({w_strength})", # ×¨×¦×•×Ÿ ×”×™×§×•×
            values['××©× ×™×ª'], values['×¨××©×™×ª'], values['×™×§×•×'] # ×¢×¨×›×™× × ×§×™×™× ×œ×¦×‘×™×¢×”
        ])
        
    df_cycles = pd.DataFrame(cycle_data, columns=[
        '××—×–×•×¨', '×˜×•×•×— ×’×™×œ××™×', '×× ×¨×’×™×” ××©× ×™×ª', '×× ×¨×’×™×” ×¨××©×™×ª', '×¨×¦×•×Ÿ ×”×™×§×•×', 
        '__××©× ×™×ª_× ×§×™', '__×¨××©×™×ª_× ×§×™', '__×™×§×•×_× ×§×™' 
    ])
    
    # 2. ×ª×“×¨×™ ×”×©× ×•×ª×“×¨×™ ×”×œ×™×“×”
    name_freqs = calculate_name_freqs(first_name, last_name, destiny_number)
    
    # ×™×¦×™×¨×ª ××¤×” ×›×œ×œ×™×ª ×©×œ ×›×œ ×”×ª×“×¨×™× ×¢× ×©××•×ª ×”×¢××•×“×•×ª ×”×—×“×©×™×
    freqs_map = {
        '×ª×“×¨ ×”×™×™×¢×•×“ (×©×‘×™×œ ×”×’×•×¨×œ)': {'freq': destiny_number, 'category': '×œ×™×“×”'},
        '×ª×“×¨ ×”×ª×©×•×§×” (×™×•× ×”×œ×™×“×”)': {'freq': day_reduced, 'category': '×œ×™×“×”'},
        '×ª×“×¨ ××–×œ ××¡×˜×¨×•×œ×•×’×™': {'freq': astro_number, 'category': '×œ×™×“×”', 'sign': astro_sign},
        
        '×ª×“×¨ ×¡×‘×™×‘×ª×™': {'freq': name_freqs['×ª×“×¨ ×¡×‘×™×‘×ª×™'], 'category': '×©×'},
        '×ª×“×¨ ×ª×¢×¡×•×§×”': {'freq': name_freqs['×ª×“×¨ ×ª×¢×¡×•×§×”'], 'category': '×©×'},
        '×ª×“×¨ ×”×—×•×¡×¨': {'freq': name_freqs['×ª×“×¨ ×”×—×•×¡×¨'], 'category': '×©×'},
        '×ª×“×¨ ×”×‘×™×˜×•×™ ×•×”×—×©×™×‘×”': {'freq': name_freqs['×ª×“×¨ ×”×‘×™×˜×•×™ ×•×”×—×©×™×‘×”'], 'category': '×©×'},
        '×ª×“×¨ ×”×ª×ª ××•×“×¢': {'freq': name_freqs['×ª×“×¨ ×”×ª×ª ××•×“×¢'], 'category': '×©×'},
        '×ª×“×¨ ×”×©×': {'freq': name_freqs['×ª×“×¨ ×”×©×'], 'category': '×©×'}
    }
    
    birth_data = []
    name_data = []
    analysis_text = []

    for name, info in freqs_map.items():
        freq = info['freq']
        
        # ×˜×™×¤×•×œ ××™×•×—×“ ×‘×ª×“×¨ ×”××¡×˜×¨×•×œ×•×’×™
        if name == '×ª×“×¨ ××–×œ ××¡×˜×¨×•×œ×•×’×™':
            strength = get_strength_text(name, freq, info['sign'])
            value_display = f"{freq} ({info['sign']})"
        else:
            strength = get_strength_text(name, freq)
            value_display = freq

        row = [name, value_display, strength, freq]
        
        # ×™×¦×™×¨×ª × ×™×ª×•×— ××™×œ×•×œ×™ - ×©×™××•×© ×‘×©× ×”×ª×“×¨ ×”× ×§×™ ×›-Key
        name_for_analysis = name.split('(')[0].strip()
        desc = get_chakra_description_text(freq, name_for_analysis)
        
        if "×œ× × ××¦× × ×™×ª×•×—" not in desc:
            analysis_text.append(f"**{name}** ({freq}): {desc}")

        if info['category'] == '×œ×™×“×”':
            birth_data.append(row)
        else:
            name_data.append(row)

    df_birth = pd.DataFrame(birth_data, columns=['×©× ×”×ª×“×¨', '×¢×¨×š × ×•××¨×•×œ×•×’×™', '×¢×•×¦××ª ×”×ª×“×¨', '__×ª×“×¨_× ×§×™'])
    df_name = pd.DataFrame(name_data, columns=['×©× ×”×ª×“×¨', '×¢×¨×š × ×•××¨×•×œ×•×’×™', '×¢×•×¦××ª ×”×ª×“×¨', '__×ª×“×¨_× ×§×™'])
    
    # ğŸš¨ DataFrame ×©×œ ×”×ª×“×¨×™× ×”××™×©×™×™× (×—×“×©)
    personal_cycles_data = [
        ['×©× ×” ××™×©×™×ª', py_freq, get_strength_text('×©× ×” ××™×©×™×ª', py_freq), py_freq, f" (×—×™×©×•×‘ ×œ×©× ×ª {py_year})"],
        ['×—×•×“×© ××™×©×™', pm_freq, get_strength_text('×—×•×“×© ××™×©×™', pm_freq), pm_freq, f" ({current_date.month}/{current_date.year})"],
        ['×™×•× ××™×©×™', pd_freq, get_strength_text('×™×•× ××™×©×™', pd_freq), pd_freq, f" ({current_date.day}/{current_date.month}/{current_date.year})"]
    ]

    df_personal_cycles = pd.DataFrame(personal_cycles_data, columns=['×ª×“×¨ ×“×™× ××™', '×¢×¨×š × ×•××¨×•×œ×•×’×™', '×¢×•×¦××ª ×”×ª×“×¨', '__×ª×“×¨_× ×§×™', '×”×¢×¨×”'])

    return df_cycles, df_birth, df_name, df_personal_cycles, "\n\n".join(analysis_text)


# 8. ×§×•×“ ×”×××©×§ ×©×œ Streamlit (×œ×¦×•×¨×š ×”×¦×’×ª ×”×ª×•×¦××•×ª)
# -------------------------------------------------------------------------------------------------

def style_cycles_table(df, df_full_data):
    """×¦×•×‘×¢×ª ××ª ×˜×‘×œ×ª ××—×–×•×¨×™ ×”×—×™×™×."""
    
    df_style = pd.DataFrame('', index=df.index, columns=df.columns)
    
    p_freq_col = '×× ×¨×’×™×” ×¨××©×™×ª'
    w_freq_col = '×¨×¦×•×Ÿ ×”×™×§×•×'
    
    for i, row in df_full_data.iterrows():
        p_freq = row['__×¨××©×™×ª_× ×§×™']
        w_freq = row['__×™×§×•×_× ×§×™']
        
        p_strength = get_strength_text('×× ×¨×’×™×” ×¨××©×™×ª', p_freq)
        w_strength = get_strength_text('×¨×¦×•×Ÿ ×”×™×§×•×', w_freq)

        # ×¦×‘×™×¢×ª P: ×××¡×˜×¨/×§××¨××”/×—×–×§
        if p_strength == 'â­ ×ª×“×¨ ×××¡×˜×¨ ×—×–×§':
            df_style.loc[i, p_freq_col] = f'background-color: {COLOR_MAP_HTML["â­ ×ª×“×¨ ×××¡×˜×¨"]}; color: white; font-weight: bold;'
        elif p_strength == 'âŒ ×ª×“×¨ ×§××¨××ª×™ - ×”×™×–×”×¨':
            df_style.loc[i, p_freq_col] = f'background-color: {COLOR_MAP_HTML["âŒ ×ª×“×¨ ×§××¨××ª×™"]}; color: white;'
        elif p_strength == 'âœ… ×ª×“×¨ ×—×–×§ ×•××§×“×':
            df_style.loc[i, p_freq_col] = f'background-color: {COLOR_MAP_HTML["âœ… ×ª×“×¨ ×—×–×§"]}; color: black;'
            
        # ×¦×‘×™×¢×ª W: ××ª×’×¨ 0 / ×—×œ×©
        if w_strength == 'âšª ××ª×’×¨ ×—×–×§ ×‘××™×•×—×“':
            df_style.loc[i, w_freq_col] = f'background-color: {COLOR_MAP_HTML["âšª ××ª×’×¨ ×—×–×§ ×‘××™×•×—×“"]}; color: black; font-weight: bold;'
        elif w_strength == 'âš ï¸ ×ª×“×¨ ×—×œ×©/××¢×›×‘':
            df_style.loc[i, w_freq_col] = f'background-color: {COLOR_MAP_HTML["âš ï¸ ×ª×“×¨ ×—×œ×©/××¢×›×‘"]}; color: white;'
            
    return df_style

def highlight_general_table(s):
    """×¦×•×‘×¢×ª ×©×•×¨×” ×‘×˜×‘×œ××•×ª ×”×œ×™×“×” ×•×”×©× ×œ×¤×™ ×˜×§×¡×˜ ×”×¢×•×¦××”."""
    
    strength_text = s['×¢×•×¦××ª ×”×ª×“×¨']
    
    style = COLOR_MAP_HTML['â– ×ª×“×¨ ×××•×–×Ÿ']
    text_color = 'black'
    
    if 'â­ ×ª×“×¨ ×××¡×˜×¨' in strength_text:
        style = COLOR_MAP_HTML['â­ ×ª×“×¨ ×××¡×˜×¨']
        text_color = 'white'
    elif 'âŒ ×ª×“×¨ ×§××¨××ª×™' in strength_text:
        style = COLOR_MAP_HTML['âŒ ×ª×“×¨ ×§××¨××ª×™']
        text_color = 'white'
    elif 'âš ï¸ ×ª×“×¨ ×—×œ×©/××¢×›×‘' in strength_text: 
        style = COLOR_MAP_HTML['âš ï¸ ×ª×“×¨ ×—×œ×©/××¢×›×‘']
        text_color = 'white'
    elif 'âœ… ×ª×“×¨ ×—×–×§' in strength_text:
        style = COLOR_MAP_HTML['âœ… ×ª×“×¨ ×—×–×§']
        text_color = 'black'
        
    return [f'background-color: {style}; color: {text_color}; font-weight: bold;'] * len(s)


def main():
    
    st.set_page_config(
        page_title="× ×•××¨×•×œ×•×’×™×ª ×”×ª×“×¨ - ×ª×•××¨ ×¢×•×œ× × ×•×™", 
        layout="wide", 
        initial_sidebar_state="expanded"
    )
    
    # CSS ××•×ª×× ××™×©×™×ª ×œ-RTL ×•×œ××¨×›×•×–
    st.markdown("""
        <style>
        /* ×”×’×“×¨×ª ×›×™×•×•×Ÿ ×›×œ×œ×™ ××™××™×Ÿ ×œ×©×××œ */
        div.stApp { direction: rtl; }
        h1, h2, h3 { text-align: right; }
        
        /* ×¢×™×¦×•×‘ ×›×œ×œ×™ ×œ×˜×‘×œ××•×ª - ××¨×›×•×– ×•×’×‘×•×œ×•×ª */
        .stDataFrame table, .stDataFrame th, .stDataFrame td {
            text-align: center !important; 
            vertical-align: middle !important;
            font-size: 1.2em;
            border: 1px solid #333;
            padding: 8px 15px; 
        }
        </style>
        """, unsafe_allow_html=True)
    
    st.title("ğŸ”¢ × ×•××¨×•×œ×•×’×™×ª ×”×ª×“×¨ - ×ª×•××¨ ×¢×•×œ× × ×•×™")
    st.markdown("---")
    
    # 1. ×§×œ×™×˜×ª ×§×œ×˜ ×××©×ª××© ×‘-Sidebar 
    with st.sidebar:
        st.header("×”×–× ×ª × ×ª×•× ×™×")
        
        st.subheader("×ª××¨×™×š ×œ×™×“×”")
        today = datetime.now()
        
        col_d, col_m, col_y = st.columns(3)
        day = col_d.number_input("×™×•× (DD):", min_value=1, max_value=31, value=26, key="d")
        month = col_m.number_input("×—×•×“×© (MM):", min_value=1, max_value=12, value=11, key="m")
        year = col_y.number_input("×©× ×” (YYYY):", min_value=1900, max_value=today.year, value=1976, key="y")
        
        st.subheader("×©× ××œ× (×‘×¢×‘×¨×™×ª)")
        first_name = st.text_input("×©× ×¤×¨×˜×™:", "×ª×•××¨")
        last_name = st.text_input("×©× ××©×¤×—×”:", "× ×•×™")
        
        st.markdown("---")

        # ğŸš¨ ×§×œ×™×˜×ª ×ª××¨×™×š × ×•×›×—×™ (×œ×¦×•×¨×š ×—×™×©×•×‘ ×ª×“×¨×™× ×“×™× ××™×™×)
        st.subheader("×ª××¨×™×š × ×•×›×—×™ (×œ×—×™×©×•×‘ ×©× ×”/×—×•×“×©/×™×•× ××™×©×™)")
        current_date_input = st.date_input(
            "×‘×—×¨ ×ª××¨×™×š × ×•×›×—×™:", 
            datetime.now().date(), 
            key="current_d"
        )
        current_date = datetime.combine(current_date_input, datetime.min.time()) # ×”××¨×” ×œ-datetime object
        
        st.markdown("---")
        
        calculate_button = st.button("×œ×—×¥ ×œ×—×™×©×•×‘ ×•× ×™×ª×•×— ×”×ª×“×¨×™×", use_container_width=True)

    # 2. ×”×¦×’×ª ×”×ª×•×¦××•×ª
    if calculate_button or st.session_state.get('calculated', False):
        st.session_state['calculated'] = True
        
        try:
            # ×§×¨×™××” ×œ×¤×•× ×§×¦×™×” ×”×××•×—×“×ª
            df_cycles, df_birth, df_name, df_personal_cycles, analysis_text = run_numerology_tool(
                day, month, year, first_name, last_name, current_date # ğŸš¨ ×”×¢×‘×¨×ª current_date
            )
            
            # ------------------------------------------------------
            # ×˜×‘×œ×” 1: ××—×–×•×¨×™ ×—×™×™× (Cycle Table)
            # ------------------------------------------------------
            st.header("1. ××—×–×•×¨×™ ×”×—×™×™×")
            
            cols_to_display = ['××—×–×•×¨', '×˜×•×•×— ×’×™×œ××™×', '×× ×¨×’×™×” ××©× ×™×ª', '×× ×¨×’×™×” ×¨××©×™×ª', '×¨×¦×•×Ÿ ×”×™×§×•×']
            df_cycles_display = df_cycles[cols_to_display]
            
            styled_df_cycles = df_cycles_display.style.apply(
                style_cycles_table, df_full_data=df_cycles, axis=None
            )
            
            st.dataframe(styled_df_cycles, use_container_width=True, hide_index=True)
            
            st.markdown("---")

            # ------------------------------------------------------
            # ğŸš¨ ×˜×‘×œ×” 2: ×ª×“×¨×™× ×“×™× ××™×™× (×©× ×”, ×—×•×“×©, ×™×•× ××™×©×™)
            # ------------------------------------------------------
            st.header("2. ×ª×“×¨×™× ××™×©×™×™× (×©× ×”, ×—×•×“×©, ×™×•× - ×“×™× ××™)")
            
            # ×”×¢××•×“×•×ª ×”×¨×œ×•×•× ×˜×™×•×ª ×œ×ª×¦×•×’×”
            df_personal_display = df_personal_cycles[['×ª×“×¨ ×“×™× ××™', '×¢×¨×š × ×•××¨×•×œ×•×’×™', '×¢×•×¦××ª ×”×ª×“×¨', '×”×¢×¨×”']]
            
            styled_df_personal = df_personal_display.style.apply(
                highlight_general_table, axis=1
            )
            st.dataframe(styled_df_personal, use_container_width=True, hide_index=True)

            st.markdown("---")
            
            # ------------------------------------------------------
            # ×˜×‘×œ×” 3: ×ª×“×¨×™ ×”×œ×™×“×” (×§×‘×•×¢×™×)
            # ------------------------------------------------------
            st.header("3. ×ª×“×¨×™ ×”×œ×™×“×” (×§×‘×•×¢×™×)")
            
            df_birth_display = df_birth[['×©× ×”×ª×“×¨', '×¢×¨×š × ×•××¨×•×œ×•×’×™', '×¢×•×¦××ª ×”×ª×“×¨']]
            styled_df_birth = df_birth_display.style.apply(
                highlight_general_table, axis=1
            )
            st.dataframe(styled_df_birth, use_container_width=True, hide_index=True)

            st.markdown("---")
            
            # ------------------------------------------------------
            # ×˜×‘×œ×” 4: ××¤×ª ×ª×“×¨×™ ×”×©×
            # ------------------------------------------------------
            st.header("4. ××¤×ª ×ª×“×¨×™ ×”×©×")
            
            df_name_display = df_name[['×©× ×”×ª×“×¨', '×¢×¨×š × ×•××¨×•×œ×•×’×™', '×¢×•×¦××ª ×”×ª×“×¨']]
            styled_df_name = df_name_display.style.apply(
                highlight_general_table, axis=1
            )
            st.dataframe(styled_df_name, use_container_width=True, hide_index=True)

            st.markdown("---")
            
            # ------------------------------------------------------
            # 5. × ×™×ª×•×— ×”×©×™×œ×•×‘×™×
            # ------------------------------------------------------
            st.header("5. ×©×™×œ×•×‘×™× (× ×™×ª×•×— ××™×©×™×•×ª)")
            
            if analysis_text:
                st.markdown(analysis_text)
            else:
                st.info("×œ× × ××¦××• × ×ª×•× ×™× ×œ× ×™×ª×•×— ×©×™×œ×•×‘×™×.")
            
        except Exception as e:
            st.error(f"××™×¨×¢×” ×©×’×™××” ×‘×—×™×©×•×‘ ×”× ×•××¨×•×œ×•×’×™. ×•×“× ×©×”×§×œ×˜ × ×›×•×Ÿ. ×©×’×™××”: {e}")

# ----------------------------------------------------
# ×”×¤×¢×œ×ª ×”××¤×œ×™×§×¦×™×” (×›× ×§×•×“×ª ×›× ×™×¡×” ×¨××©×™×ª)
# ----------------------------------------------------
if __name__ == '__main__':
    main()
